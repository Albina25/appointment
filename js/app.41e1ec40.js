(function(t){function e(e){for(var s,o,l=e[0],i=e[1],c=e[2],d=0,m=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&m.push(n[o][0]),n[o]=0;for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);p&&p(e);while(m.length)m.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],s=!0,l=1;l<a.length;l++){var i=a[l];0!==n[i]&&(s=!1)}s&&(r.splice(e--,1),t=o(o.s=a[0]))}return t}var s={},n={app:0},r=[];function o(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=s,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(a,s,function(e){return t[e]}.bind(null,s));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/appointment/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],i=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var p=i;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0821":function(t,e,a){t.exports=a.p+"img/list-item.2ad7e2ae.svg"},"104d":function(t,e,a){"use strict";a("ed81")},3677:function(t,e,a){},"48bd":function(t,e,a){"use strict";a("bb82")},"56d7":function(t,e,a){"use strict";a.r(e);var s=a("2b0e"),n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app"},[t._m(0),e("div",{staticClass:"main-block"},[e("header",{staticClass:"header"},[e("div",{staticClass:"align-row margin_48"},[t._m(1),t._m(2),e("div",{staticClass:"header__trolley col-md-2"},[t._m(3),e("div",{staticClass:"count-in-trolley"},[t._v(" "+t._s(t.countInTrolley)+" ")])])])]),e("main",[e("div",{staticClass:"inner-page"},[e("div",{staticClass:"align-row m80"},[e("div",{staticClass:"block-calendar"},[e("div",{staticClass:"block-calendar_wrapper"},[e("h4",{staticClass:"block-calendar__title"},[t._v("Предварительный медицинский осмотр лиц, поступающих в учебные заведения гражданской авиации (ГА)")]),e("block-calendar")],1)]),e("block-employees",{staticClass:"employees"})],1)])])])])},r=[function(){var t=this,e=t._self._c;return e("aside",{staticClass:"left-block"},[e("a",{staticClass:"logo",attrs:{href:""}},[e("img",{staticClass:"logo-img",attrs:{src:a("e347"),alt:"logo"}})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"header__contract-data col-md-8"},[e("a",[e("img",{attrs:{src:a("ac3b"),alt:"arrow"}})]),e("span",{staticClass:"contract-data margin-left_m"},[t._v("1205-20 от 01.01.2020")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"header__company col-md-2"},[e("img",{attrs:{src:a("7543"),alt:"logo-technonikol"}}),e("span",{staticClass:"margin-left_s"},[t._v('ООО "Технониколь"')])])},function(){var t=this,e=t._self._c;return e("a",{attrs:{href:""}},[e("img",{attrs:{src:a("da65"),alt:"trolley"}})])}],o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"calendar"},[e("div",{staticClass:"align-row m0 mb15"},t._l(t.months,(function(a){return e("div",{key:a,staticClass:"calendar__months",class:{"calendar__months--active":t.activeMonth(a)},on:{click:function(e){return t.selectMonth(a)}}},[t._v(t._s(a))])})),0),e("div",{staticClass:"align-row sum-space-month"},[e("div",{staticClass:"calendar__current-month"},[t._v(t._s(t.allMonths[t.currentMonth]))]),e("div",{staticClass:"free-space"},[t._v("Свободных мест "+t._s(t.allFreeSpaces)+" из 1000")])]),e("table",{staticClass:"calendar__table"},[e("thead",{staticClass:"calendar__header"},[e("tr",t._l(t.daysWeek,(function(a){return e("td",{key:a,staticClass:"calendar__day-week"},[t._v(t._s(a))])})),0)]),e("tbody",{staticClass:"calendar__body"},t._l(t.days,(function(a,s){return e("tr",{key:"week_"+s},t._l(a,(function(a,s){return e("td",{key:"day_"+s,staticClass:"calendar__td"},[e("calendar-cell",{attrs:{day:a,currentMonth:t.currentMonth,employeesIdForDayAppointment:t.getEmployeesIdForDayAppointment(a)},on:{addEmployeeIdInCalendar:t.changeFreeSpacesInCalendar}})],1)})),0)})),0)]),e("div",{staticClass:"align-row"},[e("div",{staticClass:"align-column contract-spaces"},[e("span",{staticClass:"contract-spaces__text"},[t._v("Мест по договору")]),e("span",{staticClass:"contract-spaces__count text-black"},[t._v(t._s(t.contractSpaces))])]),e("div",{staticClass:"align-column contract-spaces"},[e("span",{staticClass:"contract-spaces__text"},[t._v("Записанных")]),e("span",{staticClass:"contract-spaces__count text-blue"},[t._v(t._s(t.contractBusySpaces))])]),e("div",{staticClass:"align-column contract-spaces"},[e("span",{staticClass:"contract-spaces__text"},[t._v("Свободных")]),e("span",{staticClass:"contract-spaces__count text-green"},[t._v(t._s(t.contractFreeSpaces))])]),e("button",{staticClass:"button button-blue"},[t._v("Распределить автоматически 32")]),e("button",{staticClass:"button button-red"},[t._v("Записать")])])])},l=[],i=(a("caad"),function(){var t=this,e=t._self._c;return e("div",{class:["cell",{"cell--free":t.freeSpaces>0&&t.isCurrentMonth}],on:{drop:function(e){return t.onDrop(e,t.day)},dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()}}},[e("div",{staticClass:"cell__date"},[t._v(t._s(t.date))]),t.isCurrentMonth&&t.freeSpaces>0?e("div",{class:["cell__info",{"text-yellow":t.freeSpaces<=10},{"text-green":t.freeSpaces>10}]},[t._v(" "+t._s(t.freeSpaces)+" из 50 ")]):t._e()])}),c=[];const p=[{id:1,departamentName:"Отдел продаж",employees:[{id:1,name:"Иванов Иван Иванович",appointment:""},{id:2,name:"Иванов Иван Иванович",appointment:""},{id:3,name:"Иванов Иван Иванович",appointment:""}]},{id:2,departamentName:"Склад",employees:[{id:4,name:"Иванов Иван Иванович",appointment:""},{id:5,name:"Иванов Иван Иванович",appointment:""},{id:6,name:"Иванов Иван Иванович",appointment:""},{id:7,name:"Иванов Иван Иванович",appointment:""},{id:8,name:"Иванов Иван Иванович",appointment:""},{id:9,name:"Иванов Иван Иванович",appointment:""},{id:10,name:"Иванов Иван Иванович",appointment:""},{id:11,name:"Иванов Иван Иванович",appointment:""},{id:12,name:"Иванов Иван Иванович",appointment:""},{id:13,name:"Иванов Иван Иванович",appointment:""},{id:14,name:"Иванов Иван Иванович",appointment:""}]}];var d={name:"CalendarCell",props:{day:Object,employeesIdForDayAppointment:Object,currentMonth:Number},data(){return{departaments:p}},computed:{freeSpaces(){if(this.employeesIdForDayAppointment){let t=this.employeesIdForDayAppointment.id.length;return 50-t}return 50},date(){return new Date(this.day.dayDate).getDate()},isCurrentMonth(){return this.currentMonth===new Date(this.day.dayDate).getMonth()}},methods:{formatMonth(t){return(t+1<10?"0":"")+(t+1)},onDrop(t,e){const a=t.dataTransfer.getData("employeeID"),s=t.dataTransfer.getData("departamentID"),n=new Date(this.day.dayDate).getDate(),r=this.formatMonth(new Date(this.day.dayDate).getMonth()),o=new Date(this.day.dayDate).getFullYear(),l=`${n}.${r}.${o}`,i=p.findIndex(t=>t.id==s),c=p[i].employees.findIndex(t=>t.id==a);p[i].employees[c].appointment=l,this.$emit("addEmployeeIdInCalendar",a,e.dayDate)}}},m=d,u=(a("e1ec"),a("2877")),h=Object(u["a"])(m,i,c,!1,null,"ce9839f6",null),y=h.exports,_={name:"BlockCalendar",components:{CalendarCell:y},data(){return{departaments:p,countInTrolley:0,days:[],appointments:[],allFreeSpaces:1e3,contractSpaces:100,contractBusySpaces:0,contractFreeSpaces:100,date:new Date,currentMonth:(new Date).getMonth(),year:(new Date).getFullYear(),daysWeek:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],allMonths:["Январь","Февраль","Март","Арпель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],months:["Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],lastDay:null}},created(){this.showCalendar()},watch:{departaments:{deep:!0,handler(t){let e=0;for(let a=0;a<t.length;a++)for(let s=0;s<t[a].employees.length;s++)t[a].employees[s].appointment&&e++;this.contractBusySpaces=e,this.contractFreeSpaces=100-this.contractBusySpaces,this.allFreeSpaces=1e3-this.contractBusySpaces}}},methods:{getEmployeesIdForDayAppointment(t){const e=this.appointments.find(e=>e.day.toISOString()===t.dayDate.toISOString());return e||null},changeFreeSpacesInCalendar(t,e){this.addEmployeeIdInNewDay(t,e),this.removeEmployeeIdInBeforeDay(t,e)},addEmployeeIdInNewDay(t,e){if(0===this.appointments.length)this.appointments.push({day:e,id:[t]});else{const a=this.appointments.findIndex(t=>t.day.toISOString()===e.toISOString());if(console.log("ind",a),a>=0){if(console.log("111",this.appointments[a].id),console.log("empl",t),this.appointments[a].id.includes(t))return;this.appointments[a].id.push(t)}else this.appointments.push({day:e,id:[t]})}},removeEmployeeIdInBeforeDay(t,e){this.appointments.map(a=>{if(a.id.includes(t)){if(a.day.toISOString()===e.toISOString())return;const s=a.id.indexOf(t);a.id.splice(s,1)}})},activeMonth(t){let e=this.allMonths.indexOf(t,0);if(e===this.currentMonth)return!0},showCalendar(){this.days=[];let t=0;this.days[t]=[];let e=new Date(this.year,this.currentMonth+1,0).getDate();this.lastDay=e;for(let a=1;a<=e;a++)if(1!==new Date(this.year,this.currentMonth,a).getDay()){const e={dayDate:new Date(this.year,this.currentMonth,a)};this.days[t].push(e)}else{t++,this.days[t]=[];const e={dayDate:new Date(this.year,this.currentMonth,a)};this.days[t].push(e)}if(this.days[0].length>0){let t=new Date(this.year,this.currentMonth,0).getDate();for(let e=this.days[0].length;e<7;e++){const e={dayDate:new Date(this.year,this.currentMonth-1,t)};this.days[0].unshift(e),t--}}if(this.days[t].length<7){let e=1;for(let a=this.days[t].length;a<7;a++){const a={dayDate:new Date(this.year,this.currentMonth+1,e),id:[]};e++,this.days[t].push(a)}}return this.days},selectMonth(t){let e=this.allMonths.indexOf(t,0);this.currentMonth=e,this.showCalendar()}}},f=_,g=(a("104d"),Object(u["a"])(f,o,l,!1,null,"1d42312e",null)),v=g.exports,b=function(){var t=this,e=t._self._c;return e("div",{staticClass:"employees align-column"},[t._m(0),e("div",{staticClass:"employees-header"},[e("span",{staticClass:"employees-header__all-employees text-black"},[t._v("Список сотрудников "+t._s(t.allEmployees))]),e("span",{staticClass:"employees-header__registered-employees text-blue"},[t._v("Записанных "+t._s(t.registeredEmployees))])]),t._m(1),t._l(t.departaments,(function(s){return e("table",{key:s.id,staticClass:"mb10 draggable"},[e("thead",{staticClass:"pb20"},[e("tr",[e("th",{staticClass:"employees-table__departament",attrs:{colspan:"2"}},[e("img",{staticClass:"employees-table__icon-list-item",attrs:{src:a("0821")}}),e("span",{staticClass:"mr5"},[t._v(t._s(s.departamentName))]),e("span",{staticClass:"employees-table__sumEmployees"},[t._v(t._s(t.employeesInDepartament(s)))])]),e("th",{staticClass:"employees-table__arrow",on:{click:function(e){return t.hideEmployees(s)}}},[e("img",{attrs:{src:a("c874")}})])])]),e("tbody",{staticClass:"employees-table__body",attrs:{onselectstart:"return false"}},t._l(s.employees,(function(n){return e("tr",{key:n.id,staticClass:"employees-table__tr",attrs:{"employee.draggable":"true"},on:{dragstart:function(e){return t.startDrag(e,n,s)}}},[e("td",{staticClass:"employees-table__fio"},[t._m(2,!0),e("span",[t._v(t._s(n.name))])]),e("td",{staticClass:"employees-table__appointment"},[t._v(t._s(t.formatAppointment(n.appointment)))]),e("td",{staticClass:"employees-table__trash",on:{click:function(e){return t.deleteEmployee(s.employees,n)}}},[e("img",{staticClass:"test",attrs:{src:a("c2c4")}})])])})),0)])}))],2)},C=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"align-row m45"},[e("button",{staticClass:"button button-red"},[t._v("Добавить сотрудников")]),e("button",{staticClass:"button button-white"},[e("img",{staticClass:"trash",attrs:{src:a("c2c4")}}),t._v(" Удалить всех ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"align-row employees-table__header"},[e("span",{staticClass:"mr21"},[t._v("ФИО")]),e("span",[t._v("Дата записи")])])},function(){var t=this,e=t._self._c;return e("span",[e("img",{staticClass:"employees-table__icon-list-item",attrs:{src:a("0821")}})])}],D={name:"BlockEmployees",data(){return{allEmployees:40,registeredEmployees:0,departaments:p}},watch:{departaments:{deep:!0,handler(t){let e=0;for(let a=0;a<t.length;a++)for(let s=0;s<t[a].employees.length;s++)t[a].employees[s].appointment&&e++;this.registeredEmployees=e}}},methods:{startDrag(t,e,a){t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("employeeID",e.id),t.dataTransfer.setData("departamentID",a.id)},formatAppointment(t){return""===t?"-.--.----":t},employeesInDepartament(t){return t.employees.length},deleteEmployee(t,e){let a=t.indexOf(e);t.splice(a,1)},hideEmployees(t){const e=p.find(e=>e===t).id,a=document.querySelectorAll(".employees-table__body")[e-1];a.classList.toggle("hidden")}}},w=D,S=(a("ca2e"),Object(u["a"])(w,b,C,!1,null,"b3ce017a",null)),I=S.exports,M={name:"App",components:{BlockEmployees:I,BlockCalendar:v},data(){return{countInTrolley:0}}},x=M,k=(a("48bd"),Object(u["a"])(x,n,r,!1,null,null,null)),O=k.exports;a("c1c3");s["a"].config.productionTip=!1,new s["a"]({render:t=>t(O)}).$mount("#app")},6476:function(t,e,a){},7543:function(t,e,a){t.exports=a.p+"img/logo-technonikol.5d92c3a1.svg"},ac3b:function(t,e,a){t.exports=a.p+"img/arrow-left.559f682c.svg"},bb82:function(t,e,a){},c1c3:function(t,e,a){},c2c4:function(t,e,a){t.exports=a.p+"img/basket-delete.867a259e.svg"},c874:function(t,e,a){t.exports=a.p+"img/arrow-down.264c028f.svg"},ca2e:function(t,e,a){"use strict";a("6476")},da65:function(t,e,a){t.exports=a.p+"img/trolley.54cd4169.svg"},e1ec:function(t,e,a){"use strict";a("3677")},e347:function(t,e,a){t.exports=a.p+"img/logo.8f645610.svg"},ed81:function(t,e,a){}});
//# sourceMappingURL=app.41e1ec40.js.map